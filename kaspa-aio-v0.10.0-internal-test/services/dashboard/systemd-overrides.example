# Kaspa Dashboard Systemd Service Override Examples
# 
# To apply these overrides:
# 1. Create override directory: sudo mkdir -p /etc/systemd/system/kaspa-dashboard.service.d
# 2. Create override file: sudo nano /etc/systemd/system/kaspa-dashboard.service.d/override.conf
# 3. Copy desired sections below into the override file
# 4. Reload systemd: sudo systemctl daemon-reload
# 5. Restart service: sudo systemctl restart kaspa-dashboard

# =============================================================================
# RESOURCE LIMITS OVERRIDE
# =============================================================================
# Adjust memory and CPU limits based on your system resources

[Service]
# Increase memory limit for high-traffic installations
MemoryMax=1G
MemoryHigh=800M

# Increase CPU quota for better performance
CPUQuota=100%

# Adjust process limits
LimitNPROC=8192
TasksMax=2048

# =============================================================================
# DEVELOPMENT ENVIRONMENT OVERRIDE
# =============================================================================
# Configuration for development/testing environments

[Service]
# Disable restart for easier debugging
Restart=no

# Enable debug logging
Environment=LOG_LEVEL=debug
Environment=DEBUG_MODE=true

# Reduce security restrictions for development
NoNewPrivileges=false
ProtectSystem=false

# =============================================================================
# HIGH AVAILABILITY OVERRIDE
# =============================================================================
# Configuration for production high-availability setups

[Service]
# Faster restart on failure
RestartSec=5
StartLimitBurst=10
StartLimitInterval=600

# Shorter timeout for faster failover
TimeoutStopSec=15

# Enable watchdog for health monitoring
WatchdogSec=30

# =============================================================================
# CUSTOM ENVIRONMENT OVERRIDE
# =============================================================================
# Add custom environment variables

[Service]
# Custom Kaspa node URL
Environment=KASPA_NODE_URL=http://remote-kaspa-node:16111

# Custom port
Environment=PORT=8081

# Enable SSL
Environment=FORCE_HTTPS=true
Environment=SSL_CERT_PATH=/etc/ssl/certs/dashboard.crt
Environment=SSL_KEY_PATH=/etc/ssl/private/dashboard.key

# Custom monitoring settings
Environment=RESOURCE_MONITOR_INTERVAL=10000
Environment=CPU_CRITICAL_THRESHOLD=95

# =============================================================================
# LOGGING OVERRIDE
# =============================================================================
# Custom logging configuration

[Service]
# Disable journal logging and use file only
StandardOutput=null
StandardError=null

# Or redirect to custom log files
StandardOutput=append:/var/log/kaspa-dashboard/stdout.log
StandardError=append:/var/log/kaspa-dashboard/stderr.log

# Custom syslog configuration
SyslogLevel=debug
SyslogFacility=local0

# =============================================================================
# SECURITY HARDENING OVERRIDE
# =============================================================================
# Additional security restrictions for high-security environments

[Service]
# Additional file system protection
ProtectKernelLogs=true
ProtectClock=true
ProtectHostname=true

# Network restrictions
RestrictAddressFamilies=AF_INET AF_INET6
IPAddressDeny=any
IPAddressAllow=localhost
IPAddressAllow=127.0.0.0/8
IPAddressAllow=::1/128

# Additional capability restrictions
CapabilityBoundingSet=

# System call restrictions
SystemCallFilter=@system-service
SystemCallFilter=~@privileged @resources

# =============================================================================
# DEPENDENCY OVERRIDE
# =============================================================================
# Custom service dependencies

[Unit]
# Wait for specific services
After=docker.service postgresql.service
Requires=docker.service

# Conflict with other services
Conflicts=other-dashboard.service

# =============================================================================
# CUSTOM PATHS OVERRIDE
# =============================================================================
# Custom file system paths

[Service]
# Custom working directory
WorkingDirectory=/custom/path/to/dashboard

# Additional read-write paths
ReadWritePaths=/custom/logs
ReadWritePaths=/custom/backups

# Additional read-only paths
ReadOnlyPaths=/custom/config

# =============================================================================
# NETWORK OVERRIDE
# =============================================================================
# Custom network configuration

[Service]
# Bind to specific interface
Environment=BIND_ADDRESS=192.168.1.100

# Custom CORS origins
Environment=CORS_ORIGIN=https://dashboard.example.com,https://admin.example.com

# =============================================================================
# MONITORING INTEGRATION OVERRIDE
# =============================================================================
# Integration with external monitoring systems

[Service]
# Custom health check command
ExecStartPost=/usr/local/bin/register-service dashboard
ExecStopPost=/usr/local/bin/unregister-service dashboard

# Custom reload command
ExecReload=/bin/kill -HUP $MAINPID

# =============================================================================
# BACKUP INTEGRATION OVERRIDE
# =============================================================================
# Automatic backup integration

[Service]
# Pre-stop backup
ExecStop=/opt/kaspa-dashboard/scripts/backup.sh
ExecStop=/bin/kill -TERM $MAINPID

# =============================================================================
# COMPLETE EXAMPLE OVERRIDE
# =============================================================================
# Example combining multiple overrides for a production environment

[Unit]
# Production dependencies
After=network-online.target docker.service postgresql.service
Requires=docker.service
Wants=postgresql.service

[Service]
# Production resource limits
MemoryMax=2G
MemoryHigh=1.5G
CPUQuota=150%

# Production restart policy
RestartSec=5
StartLimitBurst=10
StartLimitInterval=600
TimeoutStopSec=15

# Production environment
Environment=NODE_ENV=production
Environment=LOG_LEVEL=info
Environment=KASPA_NODE_URL=http://kaspa-node.internal:16111
Environment=PORT=8080

# Production security
ProtectKernelLogs=true
ProtectClock=true
RestrictAddressFamilies=AF_INET AF_INET6

# Production monitoring
WatchdogSec=30
ExecStartPost=/usr/local/bin/notify-monitoring "dashboard started"
ExecStopPost=/usr/local/bin/notify-monitoring "dashboard stopped"

# =============================================================================
# NOTES
# =============================================================================

# 1. Only include the [Service] or [Unit] sections you need to override
# 2. Test overrides in a development environment first
# 3. Monitor service behavior after applying overrides
# 4. Keep backups of working configurations
# 5. Use 'systemctl show kaspa-dashboard' to verify applied settings
# 6. Use 'systemctl cat kaspa-dashboard' to see the complete configuration