# Batch Processor Configuration for K Protocol Transactions (Rust)
# Optimized for 1000-record batches with TimescaleDB integration

[batch_processor]
enabled = true
batch_size = 1000
max_wait_time = 5000  # milliseconds
parallel_batches = 4
retry_attempts = 3
retry_delay = 1000  # milliseconds

# Batch types configuration
[batch_types.posts]
enabled = true
table_name = "k_posts"
batch_size = 1000
max_wait_time = 5000

[batch_types.votes]
enabled = true
table_name = "k_votes"
batch_size = 1000
max_wait_time = 5000

[batch_types.profiles]
enabled = true
table_name = "k_user_profiles"
batch_size = 500  # Profiles change less frequently
max_wait_time = 10000

[batch_types.follows]
enabled = true
table_name = "k_follows"
batch_size = 1000
max_wait_time = 5000

[batch_types.transactions]
enabled = true
table_name = "k_transactions"
batch_size = 1000
max_wait_time = 3000  # High frequency

# Performance metrics
[metrics]
enable_metrics = true
metrics_interval = 60000  # milliseconds
enable_batch_timing = true
enable_throughput_metrics = true
enable_error_tracking = true

# Database optimization
[database]
use_prepared_statements = true
connection_pool_size = 10
query_timeout = 30000  # milliseconds
batch_insert_method = "copy"  # Use PostgreSQL COPY for bulk inserts

# Error handling
[error_handling]
max_retries = 3
retry_backoff_ms = 1000
dead_letter_queue = true
error_log_level = "warn"