# Developer Mode Quick Reference

## Overview

Developer Mode is a cross-cutting feature that adds development tools and debugging capabilities to any selected profile in the Kaspa All-in-One installation wizard.

## Features

### Debug Logging
- **Environment Variable**: `LOG_LEVEL=debug`
- **Effect**: Enables verbose logging across all services
- **Use Case**: Troubleshooting issues, understanding service behavior

### Portainer
- **Service**: Docker container management UI
- **Port**: 9000
- **Access**: http://localhost:9000
- **Features**:
  - View and manage all containers
  - Access container logs
  - Execute commands in containers
  - Monitor resource usage
  - Manage networks and volumes

### pgAdmin
- **Service**: PostgreSQL database management
- **Port**: 5050
- **Access**: http://localhost:5050
- **Enabled When**: Database profiles selected (Explorer, Production, Archive)
- **Features**:
  - Query databases
  - View table schemas
  - Monitor database performance
  - Backup and restore databases
  - Execute SQL commands

### Exposed Ports
- Additional service ports exposed for direct access
- Allows bypassing nginx reverse proxy for debugging
- Useful for testing API endpoints directly

### Log Access
- Direct access to service log files
- Mounted log directories for easy inspection
- Useful for debugging without Docker commands

## How to Enable

### In Wizard UI
1. Navigate to Profile Selection step
2. Select your desired profiles (Core, Explorer, etc.)
3. Toggle "Developer Mode" switch at the bottom
4. Features list expands showing what will be enabled
5. Continue with installation

### Configuration Files

When Developer Mode is enabled, the wizard generates:

#### .env File
```bash
# Developer Mode Settings
DEVELOPER_MODE=true
ENABLE_PORTAINER=true
PORTAINER_PORT=9000
ENABLE_PGADMIN=true
PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@kaspa.local
PGADMIN_PASSWORD=<auto-generated>
ENABLE_LOG_ACCESS=true
LOG_LEVEL=debug
```

#### docker-compose.override.yml
```yaml
version: "3.8"

services:
  # Portainer - Docker Management
  portainer:
    image: portainer/portainer-ce:latest
    container_name: kaspa-portainer
    restart: unless-stopped
    ports:
      - "9000:9000"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainer_data:/data
    networks:
      - kaspa-network

  # pgAdmin - Database Management (if database profiles selected)
  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: kaspa-pgadmin
    restart: unless-stopped
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@kaspa.local
      PGADMIN_DEFAULT_PASSWORD: <auto-generated>
      PGADMIN_CONFIG_SERVER_MODE: "False"
      PGADMIN_CONFIG_MASTER_PASSWORD_REQUIRED: "False"
    ports:
      - "5050:80"
    volumes:
      - pgadmin_data:/var/lib/pgadmin
    networks:
      - kaspa-network
    depends_on:
      - timescaledb

  # Service Overrides - Enable Debug Logging
  kaspa-node:
    environment:
      LOG_LEVEL: debug

  dashboard:
    environment:
      LOG_LEVEL: debug

  # ... (other services with debug logging)

volumes:
  portainer_data:
    driver: local
  pgadmin_data:
    driver: local
```

## Resource Impact

### Additional Resources Required

| Component | CPU | RAM | Disk |
|-----------|-----|-----|------|
| Portainer | 0.1 cores | 128 MB | 500 MB |
| pgAdmin | 0.2 cores | 256 MB | 1 GB |
| Debug Logs | - | - | +2-5 GB |
| **Total** | **~0.3 cores** | **~384 MB** | **~3-6 GB** |

### Port Usage
- **9000**: Portainer web UI
- **5050**: pgAdmin web UI

## Security Considerations

### ⚠️ Important Warnings

1. **Production Use**: Developer Mode should NOT be enabled in production environments
2. **Exposed Ports**: Additional ports are exposed which may be security risks
3. **Debug Logs**: Verbose logging may expose sensitive information
4. **Resource Usage**: Increased CPU, memory, and disk usage
5. **Docker Socket**: Portainer has access to Docker socket (full container control)

### Best Practices

- Only enable Developer Mode in development/testing environments
- Use firewall rules to restrict access to ports 9000 and 5050
- Regularly review and clean up debug logs
- Change default pgAdmin password after first login
- Disable Developer Mode when not actively debugging

## Common Use Cases

### 1. Debugging Container Issues
```bash
# Access Portainer at http://localhost:9000
# Navigate to Containers
# Click on problematic container
# View logs, inspect configuration, restart if needed
```

### 2. Database Inspection
```bash
# Access pgAdmin at http://localhost:5050
# Login with credentials from .env file
# Add server connection to TimescaleDB
# Host: timescaledb, Port: 5432
# Username/Password from .env file
```

### 3. Viewing Debug Logs
```bash
# With Developer Mode, all services log at debug level
docker logs kaspa-node
docker logs k-indexer
# Or use Portainer UI for easier log viewing
```

### 4. Testing API Endpoints
```bash
# With exposed ports, test APIs directly
curl http://localhost:16111/info  # Kaspa node RPC
curl http://localhost:3004/health # Indexer health check
```

## Disabling Developer Mode

### Method 1: Through Wizard
1. Open wizard in reconfiguration mode
2. Navigate to Profile Selection
3. Toggle Developer Mode off
4. Save configuration
5. Restart services

### Method 2: Manual
1. Edit `.env` file, set `DEVELOPER_MODE=false`
2. Remove `docker-compose.override.yml`
3. Restart services: `docker-compose down && docker-compose up -d`

## Troubleshooting

### Portainer Won't Start
```bash
# Check if port 9000 is already in use
sudo lsof -i :9000

# Check Portainer logs
docker logs kaspa-portainer

# Verify Docker socket access
ls -la /var/run/docker.sock
```

### pgAdmin Won't Start
```bash
# Check if port 5050 is already in use
sudo lsof -i :5050

# Check pgAdmin logs
docker logs kaspa-pgadmin

# Verify database is running
docker ps | grep timescaledb
```

### Debug Logs Too Large
```bash
# Check log sizes
docker system df

# Clean up old logs
docker system prune -a

# Rotate logs (configure in docker-compose)
```

## API Integration

### Check Developer Mode Status
```bash
GET /api/config/load
# Response includes DEVELOPER_MODE=true/false
```

### Enable Developer Mode via API
```bash
POST /api/config/save
{
  "config": {
    "DEVELOPER_MODE": true,
    ...
  },
  "profiles": ["core", "explorer"]
}
# Generates .env and docker-compose.override.yml
```

## Related Documentation

- [Profile Architecture Quick Reference](./PROFILE_ARCHITECTURE_QUICK_REFERENCE.md)
- [Configuration Management](../wizard-integration.md)
- [Docker Compose Override](https://docs.docker.com/compose/extends/)
- [Portainer Documentation](https://docs.portainer.io/)
- [pgAdmin Documentation](https://www.pgadmin.org/docs/)

## Implementation Files

### Frontend
- `services/wizard/frontend/public/index.html` - Developer Mode toggle UI
- `services/wizard/frontend/public/styles/wizard.css` - Developer Mode styles
- `services/wizard/frontend/public/scripts/modules/configure.js` - Toggle handler

### Backend
- `services/wizard/backend/src/utils/config-generator.js` - Configuration generation
- `services/wizard/backend/src/api/config.js` - Configuration API
- `services/wizard/backend/src/utils/profile-manager.js` - Profile management

### Tests
- `services/wizard/backend/test-developer-mode.js` - Developer Mode tests

## Version History

- **v1.0** (2024-01): Initial implementation
  - Developer Mode toggle in Profile Selection
  - Portainer and pgAdmin services
  - Debug logging configuration
  - docker-compose.override.yml generation
